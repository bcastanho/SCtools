<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SCtools">
<title>SCM Case Study on Alcohol Consumption • SCtools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SCM Case Study on Alcohol Consumption">
<meta property="og:description" content="SCtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SCtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case-study.html">SCM Case Study on Alcohol Consumption</a>
    <a class="dropdown-item" href="../articles/replicating-basque.html">Replicating the Basque Study</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bcastanho/SCtools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SCM Case Study on Alcohol Consumption</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bcastanho/SCtools/blob/HEAD/vignettes/case-study.Rmd" class="external-link"><code>vignettes/case-study.Rmd</code></a></small>
      <div class="d-none name"><code>case-study.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Synthetic control provides a powerful approach at establishing a
counterfactual for policy changes. One such example of a policy change
is in Russian surrounding alcohol consumption. A recent Guardian
article<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
chronicled the fall of alcohol consumption in Russia based policy
changes made by Mr Putin’s governments. These policy changes all
occurred roughly around 2006 and included reclassifying what counted as
a “foodstuff” and levying of hefty taxes on alcohol <span class="citation">(Levintova 2007)</span>. Based on recent trends,
observers say that these policies are having the desired effect. But how
much of this drop in alcohol consumption is due to the policy
implementation and not changes in consumer preference?<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>This underlines the need for a counterfactual. We would like to know
what <em>would have been</em> the alcohol consumption in Russia but for
these policy changes. Here is where Synthetic Control (and the SCtools
package) can help us answer these questions.</p>
</div>
<div class="section level2">
<h2 id="implementing-synthetic-controls">Implementing Synthetic Controls<a class="anchor" aria-label="anchor" href="#implementing-synthetic-controls"></a>
</h2>
<p>In order to understand the policy impact on Russian Alcohol
Consumption, we will first load the SCtools, Synth, and some of the
tidyverse packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SCtools</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: future</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stanford.edu/~jhain" class="external-link">Synth</a></span><span class="op">)</span>
<span class="co">#&gt; ##</span>
<span class="co">#&gt; ## Synth Package: Implements Synthetic Control Methods.</span>
<span class="co">#&gt; ## See http://www.mit.edu/~jhainm/software.htm for additional information.</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>After those are loaded, we can look at the <code>alcohol</code> data
that is inside of the <code>SCtools</code> package. We can build the
graphic in the Guardian using these data to see the trend in alcohol
consumption.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alcohol</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_name</span> <span class="op">==</span> <span class="st">"Russian Federation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">consumption</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">2006</span>, color  <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
        title <span class="op">=</span> <span class="st">"Per Capita Alcohol Consumption in the Russian Federation Since 1990"</span>,
        subtitle <span class="op">=</span> <span class="st">"The Russian government began a series of policy changes in 2003\nto reduce alcohol consumption"</span>,
        y <span class="op">=</span> <span class="st">"Per Capita Consumption (L/person)"</span>,
        x <span class="op">=</span> <span class="cn">NULL</span>,
        caption <span class="op">=</span> <span class="st">"Data: World Health Organization"</span>
    <span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/russia-graph-1.png" alt="Trend of Alcohol Consumption in Russia" width="672"><p class="caption">
Trend of Alcohol Consumption in Russia
</p>
</div>
<p>We can also examine some of the trends in our predictors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alcohol</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_name</span> <span class="op">==</span> <span class="st">"Russian Federation"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">consumption</span>,<span class="va">labor_force_participation_rate</span><span class="op">:</span><span class="va">manufacturing</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">predictor</span>, <span class="va">value</span>, <span class="op">-</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">predictor</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/unnamed-chunk-3-1.png" alt="Trends in Predictors in Russian Federation" width="672"><p class="caption">
Trends in Predictors in Russian Federation
</p>
</div>
<p>One feature of SCM is selecting donor states. These donor states help
us to generate our synthetic control (synthetic version of Russian in
the absence of the policy change). There are several key assumptions
regarding choosing donor states including</p>
<ul>
<li>No spillover effects (e.g. the policy change in Russia did not cause
a huge migration of drinkers to another country, did not change trade
patterns, etc)</li>
<li>Donor states do not enact similar policies</li>
</ul>
<p>In the absence of evidence of other changes in other states, we can
look at the potential donor states graphically:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">alcohol</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>my_color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">country_code</span> <span class="op">==</span> <span class="st">"RUS"</span>, <span class="st">"Russia"</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">consumption</span>, group <span class="op">=</span> <span class="va">country_code</span>, color <span class="op">=</span> <span class="va">my_color</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey"</span>, <span class="st">"black"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">15</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">1990</span>,<span class="fl">2005</span><span class="op">)</span>
<span class="va">p1</span>
<span class="co">#&gt; Warning: Removed 3579 row(s) containing missing values (geom_path).</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/unnamed-chunk-4-1.png" alt="Review of Possible Donors" width="480"><p class="caption">
Review of Possible Donors
</p>
</div>
<p>When we look at the potential donors we see the usual suspects:
France, United States, as well as some of the neighbouring Baltic
states. This makes some intuitive sense. Baltic states share similar
cultural habits. SCM is insensitive to having donors that are not
neighbouring, which will allow us to include countries like Great
Britain and the United States in the donor pool.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="section level3">
<h3 id="experimental-design">Experimental Design<a class="anchor" aria-label="anchor" href="#experimental-design"></a>
</h3>
<p>Now that we have an idea of the donors, we can build the pool.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comparison_states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"UK"</span>, <span class="st">"UKR"</span>, <span class="st">"KAZ"</span>,
                                             <span class="st">"GBR"</span>, <span class="st">"ESP"</span>, <span class="st">"DEU"</span>, <span class="st">"POL"</span>,
                                             <span class="st">"FIN"</span>, <span class="st">"FRA"</span>, <span class="st">"GRC"</span>, <span class="st">"IRL"</span>,
                                             <span class="st">"LTU"</span>, <span class="st">"ROU"</span>, <span class="st">"GEO"</span>, <span class="st">"MDA"</span>,
                                             <span class="st">"SWE"</span>, <span class="st">"BEL"</span>, <span class="st">"BLR"</span>, <span class="st">"KGZ"</span>,
                                             <span class="st">"CZE"</span>, <span class="st">"MEX"</span>, <span class="st">"SVN"</span><span class="op">)</span>

<span class="va">control_ids</span> <span class="op">&lt;-</span> <span class="va">alcohol</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">country_code</span>,<span class="va">country_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">comparison_states</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">country_num</span><span class="op">)</span></code></pre></div>
<p>Now we will use the <code>dataprep</code> function from Synth to
format our data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataprep.out</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/dataprep.html" class="external-link">dataprep</a></span><span class="op">(</span>
        foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">alcohol</span><span class="op">)</span>,
        predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"labor_force_participation_rate"</span>,
                       <span class="st">"inflation"</span>,
                       <span class="st">"mobile_cellular_subscriptions"</span>,
                       <span class="st">"manufacturing"</span><span class="op">)</span>,
        predictors.op <span class="op">=</span> <span class="st">"mean"</span>,
        dependent <span class="op">=</span> <span class="st">"consumption"</span>,
        unit.variable <span class="op">=</span> <span class="st">"country_num"</span>,
        time.variable <span class="op">=</span> <span class="st">"year"</span>,
        treatment.identifier <span class="op">=</span> <span class="fl">142</span>,
        controls.identifier <span class="op">=</span> <span class="va">control_ids</span>,
        time.predictors.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1991</span><span class="op">:</span><span class="fl">2005</span><span class="op">)</span>,
        time.optimize.ssr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">:</span><span class="fl">2005</span><span class="op">)</span>,
        special.predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"consumption"</span>, <span class="fl">2000</span><span class="op">:</span><span class="fl">2005</span> ,<span class="st">"mean"</span><span class="op">)</span><span class="op">)</span>,
        unit.names.variable <span class="op">=</span> <span class="st">"country_code"</span>,
        time.plot <span class="op">=</span> <span class="fl">1992</span><span class="op">:</span><span class="fl">2015</span>
    <span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: inflation ; for period: 1991 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: inflation ; for period: 1992 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1991 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1992 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1993 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1994 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1995 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1996 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1997 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1998 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 1999 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 2000 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data- treated unit; predictor: manufacturing ; for period: 2001 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data - control unit: 16 ; predictor: inflation ; for period: 1991 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Missing data - control unit: 16 ; predictor: inflation ; for period: 1992 </span>
<span class="co">#&gt;  We ignore (na.rm = TRUE) all missing values for predictors.op.</span></code></pre></div>
<p>There are some missing values, but that should be ok. Now we will run
the <code>synth</code> function to generate our synthetic controls.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Synth/man/synth.html" class="external-link">synth</a></span><span class="op">(</span><span class="va">dataprep.out</span>, Sigf.ipop <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>After running the SCM, we can look at the weights from the donors and
see if we see anything that is surprising.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">solution</span> <span class="op">&lt;-</span> <span class="va">out</span><span class="op">$</span><span class="va">solution.w</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">solution</span><span class="op">$</span><span class="va">country_num</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">solution</span><span class="op">)</span>

<span class="va">solution</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>country_num <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">country_num</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">alcohol</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">country_code</span>,<span class="va">country_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">comparison_states</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"country_num"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">country_code</span>, <span class="va">w.weight</span><span class="op">)</span>, <span class="va">w.weight</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
        title <span class="op">=</span> <span class="st">"Donor Weights by Country"</span>,
        y <span class="op">=</span> <span class="cn">NULL</span>,
        x <span class="op">=</span> <span class="st">"Weight"</span>
    <span class="op">)</span></code></pre></div>
<p><img src="case-study_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Unsurprisingly, we can see that Kazakstan and Lithuania contribute to
counterfactual Russia, however, interestingly Great Britain and the
Chzech Republic are amongst the top donors to the counterfactual. This
highlights one of the powerful features of Synthetic Control - the
donors do not need to be geographically connected, Let’s continue with
our analysis.</p>
<p>Now we can plot our real Russia vs our Synthetic Russia using the
<code>plot.path</code> function from Synth. Here we see that the
synthetic control matches 2000-2005 fairly well (which is what we
specified to optimize), but there is some opportunity to more closely
match actual Russia.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/Synth/man/path.plot.html" class="external-link">path.plot</a></span><span class="op">(</span>synth.res <span class="op">=</span> <span class="va">out</span>, dataprep.res <span class="op">=</span> <span class="va">dataprep.out</span>, 
                    Xlab <span class="op">=</span> <span class="st">"per Capita Alcohol Consumption"</span>, <span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/unnamed-chunk-10-1.png" alt="Synthetic Russia vs Actual Russia for Alcohol Consumption per Capita" width="672"><p class="caption">
Synthetic Russia vs Actual Russia for Alcohol Consumption per Capita
</p>
</div>
<p>We can also look at the delta between our real and synthetic
Russia.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">delta_out</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dataprep.out</span><span class="op">$</span><span class="va">Y1plot</span> <span class="op">-</span> <span class="op">(</span><span class="va">dataprep.out</span><span class="op">$</span><span class="va">Y0plot</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">out</span><span class="op">$</span><span class="va">solution.w</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">delta_out</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">delta_out</span><span class="op">)</span>

<span class="va">delta_out</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Difference in Alcohol Consumption Between Synthetic and Actual Russia"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<caption>Difference in Alcohol Consumption Between Synthetic and Actual
Russia</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">142</th>
<th align="left">year</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1992</td>
<td align="right">-3.28</td>
<td align="left">1992</td>
</tr>
<tr class="even">
<td align="left">1993</td>
<td align="right">-1.71</td>
<td align="left">1993</td>
</tr>
<tr class="odd">
<td align="left">1994</td>
<td align="right">-1.24</td>
<td align="left">1994</td>
</tr>
<tr class="even">
<td align="left">1995</td>
<td align="right">1.49</td>
<td align="left">1995</td>
</tr>
<tr class="odd">
<td align="left">1996</td>
<td align="right">-0.41</td>
<td align="left">1996</td>
</tr>
<tr class="even">
<td align="left">1997</td>
<td align="right">-0.60</td>
<td align="left">1997</td>
</tr>
<tr class="odd">
<td align="left">1998</td>
<td align="right">-0.10</td>
<td align="left">1998</td>
</tr>
<tr class="even">
<td align="left">1999</td>
<td align="right">0.77</td>
<td align="left">1999</td>
</tr>
<tr class="odd">
<td align="left">2000</td>
<td align="right">-0.50</td>
<td align="left">2000</td>
</tr>
<tr class="even">
<td align="left">2001</td>
<td align="right">-0.44</td>
<td align="left">2001</td>
</tr>
<tr class="odd">
<td align="left">2002</td>
<td align="right">-0.06</td>
<td align="left">2002</td>
</tr>
<tr class="even">
<td align="left">2003</td>
<td align="right">0.34</td>
<td align="left">2003</td>
</tr>
<tr class="odd">
<td align="left">2004</td>
<td align="right">0.35</td>
<td align="left">2004</td>
</tr>
<tr class="even">
<td align="left">2005</td>
<td align="right">0.53</td>
<td align="left">2005</td>
</tr>
<tr class="odd">
<td align="left">2006</td>
<td align="right">1.02</td>
<td align="left">2006</td>
</tr>
<tr class="even">
<td align="left">2007</td>
<td align="right">1.19</td>
<td align="left">2007</td>
</tr>
<tr class="odd">
<td align="left">2008</td>
<td align="right">1.27</td>
<td align="left">2008</td>
</tr>
<tr class="even">
<td align="left">2009</td>
<td align="right">1.00</td>
<td align="left">2009</td>
</tr>
<tr class="odd">
<td align="left">2010</td>
<td align="right">0.76</td>
<td align="left">2010</td>
</tr>
<tr class="even">
<td align="left">2011</td>
<td align="right">0.86</td>
<td align="left">2011</td>
</tr>
<tr class="odd">
<td align="left">2012</td>
<td align="right">0.92</td>
<td align="left">2012</td>
</tr>
<tr class="even">
<td align="left">2013</td>
<td align="right">0.09</td>
<td align="left">2013</td>
</tr>
<tr class="odd">
<td align="left">2014</td>
<td align="right">-1.00</td>
<td align="left">2014</td>
</tr>
<tr class="even">
<td align="left">2015</td>
<td align="right">-1.46</td>
<td align="left">2015</td>
</tr>
</tbody>
</table>
<p>It appears that the policy took a while to take effect, with a
decrease in alcohol consumed per capita beginning in 2014. However, it
must be mentioned that this isn’t the “40%” that the Guardian reports
and that one may glean from the WHO graph at first glance.</p>
</div>
</div>
<div class="section level2">
<h2 id="the-next-steps">The Next Steps<a class="anchor" aria-label="anchor" href="#the-next-steps"></a>
</h2>
<p>The next steps in a SCM controls analysis is to permute the data set
to understand the sensitivity of our Synthetic controls to assess if the
results observed are plausible (e.g. are the results we obtained due
from chance, or reflect the true effect). The SCtools provides the
<code>generate.placebos</code> function to automate this process. This
includes the option to parallelise the operation (which greatly speeds
up processing time).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">placebo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.placebos.html">generate.placebos</a></span><span class="op">(</span>dataprep.out <span class="op">=</span> <span class="va">dataprep.out</span>,
                             synth.out <span class="op">=</span> <span class="va">out</span>, strategy <span class="op">=</span> <span class="st">"multiprocess"</span><span class="op">)</span></code></pre></div>
<p>Now that we have our placebo object, we can represent it graphically
with <code>plot_placebos</code>. Here we can see our donors (control
unit) and our actual treated group.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_placebos.html">plot_placebos</a></span><span class="op">(</span><span class="va">placebo</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/unnamed-chunk-14-1.png" alt="Placebo Plot for Control Units" width="672"><p class="caption">
Placebo Plot for Control Units
</p>
</div>
<p>Equally important we can test the Mean Squared Prediction Error
(MSPE). Additionally, because we generated the controls for the
placebos, we can see how extreme our values are and thus generate a
pseudo p-value to see if our results are significant. Now, it should be
mentioned that this test is relatively underpowered as it looks only at
the donor states.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mspe.test.html">mspe.test</a></span><span class="op">(</span><span class="va">placebo</span><span class="op">)</span>
<span class="va">test_out</span><span class="op">$</span><span class="va">p.val</span>
<span class="co">#&gt; [1] 0.6521739</span></code></pre></div>
<p>Why look at single number summary, when you can look at a plot? With
<code>mspe.plot</code> we can visualise the ratios of MSPE for each
donor. Here we see very little difference in Russia, which supports our
higher p-value.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/mspe.plot.html">mspe.plot</a></span><span class="op">(</span>tdf <span class="op">=</span> <span class="va">placebo</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="case-study_files/figure-html/unnamed-chunk-16-1.png" alt="Mean Squared Prediction Error Ratios for Russia and Donors" width="672"><p class="caption">
Mean Squared Prediction Error Ratios for Russia and Donors
</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In the case of this study, it doesn’t look like the policy had an
impact. However, this brings into question the model specification. The
predictors in the model did not necessarily generate the best
pre-treatment MSPE. Different predictors may help us better construct a
Synthetic Russia. Additionally, this model could be tuned by including
some lagged predictors. We won’t go into details regarding this process,
but with SCtools, you now have tools to help you with your model
inference and tuning.</p>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-levintova_russian_2007" class="csl-entry">
Levintova, M. 2007. <span>“Russian Alcohol Policy in the Making.”</span>
<em>Alcohol and Alcoholism</em> 42 (5): 500–505. <a href="https://doi.org/10.1093/alcalc/agm040" class="external-link">https://doi.org/10.1093/alcalc/agm040</a>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Available at <a href="https://www.theguardian.com/world/2019/oct/01/russian-alcohol-consumption-down-40-since-2003-who" class="external-link uri">https://www.theguardian.com/world/2019/oct/01/russian-alcohol-consumption-down-40-since-2003-who</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Yes, we all know as good economists that as goods get
more expensive, consumers will buy less of them. However, <em>how much
less</em> is another question.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>I would recommend using the <code>plotly</code> package
which allows you to hover over the different lines and see the country
codes.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Bruno Castanho Silva, Michael DeWitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
