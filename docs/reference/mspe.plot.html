<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot the post/pre-treatment MSPE ratio — mspe.plot • SCtools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot the post/pre-treatment MSPE ratio — mspe.plot" />
<meta property="og:description" content="Plots the post/pre-treatment mean square prediction error ratio 
    for the treated unit and placebos." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SCtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/case-study.html">SCM Case Study on Alcohol Consumption</a>
    </li>
    <li>
      <a href="../articles/replicating-basque.html">Replicating the Basque Study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot the post/pre-treatment MSPE ratio</h1>
    
    <div class="hidden name"><code>mspe.plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plots the post/pre-treatment mean square prediction error ratio 
    for the treated unit and placebos.</p>
    </div>

    <pre class="usage"><span class='fu'>mspe.plot</span>(<span class='no'>tdf</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mspe.limit</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>plot.hist</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Post/Pre MSPE ratio"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)

<span class='fu'>mspe_plot</span>(<span class='no'>tdf</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mspe.limit</span> <span class='kw'>=</span> <span class='fl'>20</span>,
  <span class='kw'>plot.hist</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>title</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"Post/Pre MSPE ratio"</span>,
  <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tdf</th>
      <td><p>An object constructed by <code><a href='generate.placebos.html'>generate.placebos</a></code>.</p></td>
    </tr>
    <tr>
      <th>discard.extreme</th>
      <td><p>Logical. Whether or not placebos with high 
pre-treatement MSPE should be excluded from the plot.</p></td>
    </tr>
    <tr>
      <th>mspe.limit</th>
      <td><p>Numerical. Used if <code>discard.extreme</code> is <code>TRUE</code>. 
It indicates how many times the pretreatment MSPE of a placebo should 
be higher than that of the treated unit to be considered extreme and 
discarded. Default is <code>20</code>.</p></td>
    </tr>
    <tr>
      <th>plot.hist</th>
      <td><p>Logical. If <code>FALSE</code>, a dotplot with each unit name 
and its post/pre treatment MSPE ratio is produced. If <code>TRUE</code>, 
a histogram is produced, with the frequency of each ratio. 
Should be set to <code>TRUE</code> when there are many controls, to make 
visualization easier.</p></td>
    </tr>
    <tr>
      <th>title</th>
      <td><p>Character. Optional. Title of the plot.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p>Character. Optional. Label of the x axis.</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p>Character. Optional. Label of the y axis.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Post/pre-treatement mean square prediction error ratio is the 
    difference between the observed outcome of a unit and its synthetic 
    control, before and after treatement. A higher ratio means a small 
    pretreatment prediction error (a good synthetic control), and a high 
    post-treatment MSPE, meaning a large difference between the unit and 
    its synthetic control after the intervention. By calculating this ratio 
    for all placebos, the test can be interpreted as looking at how likely 
    the result obtained for a single treated case with a synthetic control 
    analysis could have occurred by chance given no treatement. 
    For more detailed description, see Abadie, Diamond, and Hainmueller (2011, 2014).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Abadie, A., Diamond, A., Hainmueller, J. (2014). 
  Comparative Politics and the Synthetic Control Method. 
  American Journal of Political Science Forthcoming 2014.</p>
<p>Synthetic : An R Package for Synthetic Control Methods in Comparative 
   Case Studies. Journal of Statistical Software 42 (13) 1–17.</p>
<p>Abadie, A., Diamond, A., Hainmueller, J. (2011). Synth: An R Package for 
   Synthetic Control Methods in Comparative Case Studies. 
   Journal of Statistical Software 42 (13) 1–17.</p>
<p>Abadie A, Diamond A, Hainmueller J (2010). Synthetic Control Methods for 
   Comparative Case Studies: Estimating the Effect of California's Tobacco 
   Control Program. Journal of the American Statistical Association 
   105 (490) 493–505.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='generate.placebos.html'>generate.placebos</a></code>, <code><a href='mspe.test.html'>mspe.test</a></code>, 
    <code><a href='plot_placebos.html'>plot_placebos</a></code>, <code><a href='https://rdrr.io/pkg/Synth/man/synth.html'>synth</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>Synth</span>)
<span class='co'># Load the simulated data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>synth.data</span>)

<span class='co'># Execute dataprep to produce the necessary matrices for 'Synth'</span>
<span class='no'>dataprep.out</span><span class='kw'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/pkg/Synth/man/dataprep.html'>dataprep</a></span>(
    <span class='kw'>foo</span> <span class='kw'>=</span> <span class='no'>synth.data</span>,
    <span class='kw'>predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"X1"</span>, <span class='st'>"X2"</span>, <span class='st'>"X3"</span>),
    <span class='kw'>predictors.op</span> <span class='kw'>=</span> <span class='st'>"mean"</span>,
    <span class='kw'>dependent</span> <span class='kw'>=</span> <span class='st'>"Y"</span>,
    <span class='kw'>unit.variable</span> <span class='kw'>=</span> <span class='st'>"unit.num"</span>,
    <span class='kw'>time.variable</span> <span class='kw'>=</span> <span class='st'>"year"</span>,
    <span class='kw'>special.predictors</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1991</span>, <span class='st'>"mean"</span>),
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1985</span>, <span class='st'>"mean"</span>),
      <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"Y"</span>, <span class='fl'>1980</span>, <span class='st'>"mean"</span>)
    ),
    <span class='kw'>treatment.identifier</span> <span class='kw'>=</span> <span class='fl'>7</span>,
    <span class='kw'>controls.identifier</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>29</span>, <span class='fl'>2</span>, <span class='fl'>13</span>, <span class='fl'>17</span>),
    <span class='kw'>time.predictors.prior</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1989</span>),
    <span class='kw'>time.optimize.ssr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1984</span>:<span class='fl'>1990</span>),
    <span class='kw'>unit.names.variable</span> <span class='kw'>=</span> <span class='st'>"name"</span>,
    <span class='kw'>time.plot</span> <span class='kw'>=</span> <span class='fl'>1984</span>:<span class='fl'>1996</span>
)

<span class='co'># run the synth command to create the synthetic control</span>
<span class='no'>synth.out</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Synth/man/synth.html'>synth</a></span>(<span class='no'>dataprep.out</span>)</div><div class='output co'>#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 11.69471 
#&gt; 
#&gt; solution.v:
#&gt;  0.03083419 0.008788295 0.439072 0.3008163 0.1845091 0.03598008 
#&gt; 
#&gt; solution.w:
#&gt;  0.01647626 0.1397253 0.6151521 0.2286464 
#&gt; </div><div class='input'>
<span class='co'>## run the generate.placebos command to reassign treatment status</span>
<span class='co'>## to each unit listed as control, one at a time, and generate their</span>
<span class='co'>## synthetic versions. Sigf.ipop = 2 for faster computing time. </span>
<span class='co'>## Increase to the default of 5 for better estimates. </span>
<span class='no'>tdf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='generate.placebos.html'>generate.placebos</a></span>(<span class='no'>dataprep.out</span>,<span class='no'>synth.out</span>, <span class='kw'>Sigf.ipop</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>strategy</span><span class='kw'>=</span><span class='st'>'multiprocess'</span>)</div><div class='output co'>#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 8.05617 
#&gt; 
#&gt; solution.v:
#&gt;  0.004292489 0.1380736 0.00582828 0.07443277 0.2806333 0.4967396 
#&gt; 
#&gt; solution.w:
#&gt;  0.1225372 0.636979 0.2404719 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 2918.111 
#&gt; 
#&gt; solution.v:
#&gt;  0.2902882 7.887e-07 4.054e-07 0.0002118806 0.4672674 0.2422313 
#&gt; 
#&gt; solution.w:
#&gt;  0.2922553 0.05078967 0.6569231 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 127.0044 
#&gt; 
#&gt; solution.v:
#&gt;  1e-10 0.3503472 9.4e-09 0.6496528 8e-10 1.2e-09 
#&gt; 
#&gt; solution.w:
#&gt;  0.9729072 0.001422063 0.02567068 
#&gt; 
#&gt; 
#&gt; X1, X0, Z1, Z0 all come directly from dataprep object.
#&gt; 
#&gt; 
#&gt; **************** 
#&gt;  searching for synthetic control unit  
#&gt;  
#&gt; 
#&gt; **************** 
#&gt; **************** 
#&gt; **************** 
#&gt; 
#&gt; MSPE (LOSS V): 89.6011 
#&gt; 
#&gt; solution.v:
#&gt;  0.007225619 3.38944e-05 0.1380941 0.1733409 0.2607464 0.420559 
#&gt; 
#&gt; solution.w:
#&gt;  0.2824798 0.1968938 0.5205952 
#&gt; </div><div class='input'>
<span class='co'>## Test how extreme was the observed treatment effect given the placebos:</span>
<span class='no'>ratio</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mspe.test.html'>mspe.test</a></span>(<span class='no'>tdf</span>)
<span class='no'>ratio</span>$<span class='no'>p.val</span></div><div class='output co'>#&gt; [1] 0.2</div><div class='input'>
<span class='fu'>mspe.plot</span>(<span class='no'>tdf</span>, <span class='kw'>discard.extreme</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='img'><img src='mspe.plot-1.png' alt='' width='700' height='433' /></div><div class='input'>   
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Bruno Castanho Silva, Michael DeWitt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


